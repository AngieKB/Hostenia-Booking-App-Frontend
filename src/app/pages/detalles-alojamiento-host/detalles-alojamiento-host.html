<app-main-header-host></app-main-header-host>

<div class="detalles-host-container" *ngIf="alojamiento">
  <!-- Header con título y botón editar -->
  <div class="page-header">
    <h1 class="page-title">Mi Alojamiento</h1>
    <button 
     class="btn-editar" 
    *ngIf="alojamiento.estado === 'ACTIVO'"
     (click)="verReservas()">
      Mis Reservas
    </button>

    <button 
      class="btn-editar" 
      *ngIf="alojamiento.estado === 'ACTIVO'"
      (click)="openEditModal()">
      Editar
    </button>
    <span 
      class="estado-badge estado-inactivo" 
      *ngIf="alojamiento.estado === 'INACTIVO'">
      Inactivo
    </span>
    <button class="btn-close" (click)="router.navigate(['/mis-alojamientos-host'])">
      <span class="material-icons">close</span>
    </button>
  </div>

  <!-- Galería de Imágenes -->
  <div class="galeria-section">
    <div class="imagen-principal">
      <img [src]="imagenPrincipal" [alt]="alojamiento.titulo">
    </div>
    <div class="imagenes-thumbnails">
      <div 
        class="thumbnail" 
        *ngFor="let imagen of alojamiento.galeria.slice(0, 4)"
        (click)="seleccionarImagen(imagen)">
        <img [src]="imagen" alt="Thumbnail">
      </div>
    </div>
  </div>

  <!-- Información Principal -->
  <div class="info-section">
    <div class="info-left">
      <div class="titulo-acciones">
        <div>
          <h2 class="alojamiento-titulo">{{ alojamiento.titulo }}</h2>
          <p class="ubicacion">{{ alojamiento.ubicacion.ciudad }}</p>
        </div>
        <div class="favoritos-count">
          <span class="material-icons">favorite</span>
          <span class="count-text">{{ favoritosCount }}</span>
        </div>
      </div>

      <!-- Servicios -->
      <div class="servicios-grid">
        <div class="servicio-item" *ngFor="let servicio of alojamiento.servicios">
          <i *ngIf="servicio.toLowerCase().includes('wifi')" class="bi bi-wifi servicio-icon"></i>
          <i *ngIf="servicio.toLowerCase().includes('cocina')" class="fas fa-kitchen-set servicio-icon"></i>
          <i *ngIf="servicio.toLowerCase().includes('piscina')" class="fas fa-swimming-pool servicio-icon"></i>
          <i *ngIf="servicio.toLowerCase().includes('mascotas')" class="fas fa-paw servicio-icon"></i>
          <span class="servicio-nombre">{{ servicio }}</span>
        </div>
      </div>

      <!-- Descripción -->
      <div class="descripcion-section">
        <h3>Descripción del Alojamiento</h3>
        <p>{{ alojamiento.descripcion }}</p>
      </div>
    </div>

    <!-- Card de Precio -->
    <div class="precio-card">
      <div class="precio-info">
        <span class="precio">{{ formatearPrecio(alojamiento.precioNoche) }}</span>
        <span class="precio-label">Precio por noche</span>
      </div>
    </div>
  </div>

  <!-- ... (el resto del HTML igual hasta la sección de comentarios) ... -->

<!-- Lista de Comentarios -->
<div class="comentarios-grid" *ngIf="!cargandoComentarios">
  <div class="comentario-card" *ngFor="let comentario of comentariosPaginados">
    <!-- CABECERA DEL COMENTARIO -->
    <div class="comentario-header">
      <img 
        class="comentario-avatar"
        [src]="comentario.fotoHuesped || 'assets/img/avatar-default.png'"
        alt="Foto del huésped"
      />
      <div class="comentario-info">
        <span class="comentario-autor">{{ comentario.nombreHuesped }}</span>
        <!-- Contenedor para fecha y rating en la misma línea -->
        <div class="fecha-rating-container" style="display: flex; align-items: center; gap: 8px;">
          <span class="comentario-fecha">{{ formatearFechaComentario(comentario.fecha) }}</span>
          <span class="comentario-rating">
            <span class="material-icons star">star</span>{{ comentario.calificacion }}
          </span>
        </div>
      </div>
    </div>
    <!-- TEXTO DEL COMENTARIO -->
    <p class="comentario-texto">{{ comentario.texto }}</p>
    <!-- RESPUESTA DEL ANFITRIÓN (si existe) -->
    <div class="respuesta-container" *ngIf="comentario.textoRespuesta">
      <div class="respuesta-header">
        <img 
          class="respuesta-avatar"
          [src]="comentario.fotoAnfitrion || 'assets/img/avatar-default.png'" 
        />
        <span class="respuesta-autor">{{ comentario.nombreAnfitrion }} (Anfitrión)</span>
      </div>
      <p class="respuesta-texto">{{ comentario.textoRespuesta }}</p>
    </div>
    <!-- BOTÓN INDIVIDUAL PARA RESPONDER -->
    <button class="btn-responder" (click)="responderComentario(comentario.id)">
      Responder
    </button>
  </div>

  <!-- Mensaje si no hay comentarios -->
  <div *ngIf="comentariosPaginados.length === 0" class="text-center py-4">
    <p class="text-muted">No hay comentarios aún.</p>
  </div>
</div>

<!-- ... (el resto del HTML igual) ... -->


<!-- Modal de Editar Alojamiento -->
<app-editar-alojamiento-modal
  *ngIf="showEditModal"
  [alojamiento]="alojamiento"
  (close)="closeEditModal()"
  (guardar)="onGuardarEdicion($event)">
</app-editar-alojamiento-modal>
<app-footer></app-footer>